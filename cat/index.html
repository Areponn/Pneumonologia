<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CAT – COPD Assessment Test</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=IBM+Plex+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root{--bg:#0d1117;--surface:#161b22;--surface2:#1c2330;--border:#30363d;--accent:#58a6ff;--text:#e6edf3;--text-muted:#8b949e;--low:#3fb950;--mid:#d29922;--high:#f85149;--btn-bg:#21262d;--btn-hover:#2d333b;}
  *{box-sizing:border-box;margin:0;padding:0;}
  body{font-family:'IBM Plex Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;padding:2rem 1rem 3rem;}
  .container{max-width:900px;margin:0 auto;}
  .back-link{display:inline-flex;align-items:center;gap:0.4rem;color:var(--text-muted);text-decoration:none;font-size:0.78rem;margin-bottom:1.25rem;padding:0.3rem 0.6rem;border:1px solid var(--border);border-radius:4px;transition:color 0.15s,border-color 0.15s,background 0.15s;}
  .back-link:hover{color:var(--accent);border-color:var(--accent);background:#1a2a3d;}
  header{border-left:3px solid var(--accent);padding-left:1.25rem;margin-bottom:2rem;}
  header .tag{font-family:'IBM Plex Mono',monospace;font-size:0.75rem;font-weight:600;color:var(--accent);letter-spacing:0.08em;text-transform:uppercase;}
  header h1{font-size:1.6rem;font-weight:300;margin-top:0.25rem;}
  header p{font-size:0.82rem;color:var(--text-muted);margin-top:0.4rem;}
  .reset-btn{display:inline-flex;align-items:center;gap:0.4rem;background:none;border:1px solid var(--border);border-radius:5px;color:var(--text-muted);cursor:pointer;font-family:'IBM Plex Sans',sans-serif;font-size:0.82rem;padding:0.4rem 0.85rem;margin-bottom:1.2rem;transition:background 0.15s,color 0.15s,border-color 0.15s;}
  .reset-btn:hover{background:var(--btn-hover);color:var(--high);border-color:var(--high);}
  .cat-item{background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:1.25rem 1.5rem;margin-bottom:0.8rem;transition:border-color 0.2s;}
  .cat-item:hover{border-color:#444c56;}
  .cat-labels{display:flex;justify-content:space-between;margin-bottom:0.75rem;align-items:flex-start;}
  .cat-label-left{font-size:0.88rem;color:var(--text);max-width:42%;line-height:1.4;}
  .cat-label-right{font-size:0.88rem;color:var(--text);max-width:42%;text-align:right;line-height:1.4;}
  .cat-score-badge{font-family:'IBM Plex Mono',monospace;font-size:0.75rem;color:var(--text-muted);text-align:center;min-width:48px;}
  .cat-score-badge.scored{color:var(--accent);font-weight:600;}
  .slider-row{display:flex;align-items:center;gap:0.75rem;}
  .scale-btns{display:flex;gap:0.35rem;flex:1;}
  .scale-btn{flex:1;background:var(--btn-bg);border:1px solid var(--border);border-radius:4px;color:var(--text-muted);cursor:pointer;font-family:'IBM Plex Mono',monospace;font-size:0.8rem;padding:0.45rem 0.2rem;text-align:center;transition:background 0.15s,border-color 0.15s,color 0.15s;user-select:none;}
  .scale-btn:hover{background:var(--btn-hover);border-color:#58a6ff88;color:var(--text);}
  .scale-btn.selected{background:#1a2a3d;border-color:var(--accent);color:var(--text);font-weight:600;}
  .result-panel{background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:1.5rem;margin-top:1.75rem;display:flex;gap:2rem;flex-wrap:wrap;align-items:flex-start;}
  .score-circle{display:flex;flex-direction:column;align-items:center;justify-content:center;min-width:100px;}
  .score-number{font-family:'IBM Plex Mono',monospace;font-size:4rem;font-weight:600;line-height:1;transition:color 0.35s;}
  .score-max{font-size:0.68rem;color:var(--text-muted);margin-top:0.2rem;font-family:'IBM Plex Mono',monospace;}
  .result-right{flex:1;min-width:200px;}
  .severity-label{font-size:1.25rem;font-weight:600;margin-bottom:0.2rem;transition:color 0.35s;}
  .severity-range{font-family:'IBM Plex Mono',monospace;font-size:0.72rem;color:var(--text-muted);margin-bottom:0.6rem;}
  .result-desc{font-size:0.87rem;color:var(--text-muted);line-height:1.6;}
  .c-low{color:var(--low);}.c-mid{color:var(--mid);}.c-high{color:var(--high);}
  .source{margin-top:1.25rem;font-size:0.73rem;color:var(--text-muted);line-height:1.6;padding:0.75rem 1rem;border-left:2px solid var(--border);}
  @media(max-width:580px){header h1{font-size:1.3rem;}.score-number{font-size:3rem;}.result-panel{gap:1.25rem;}.cat-labels{flex-direction:column;gap:0.3rem;}.cat-label-right{text-align:left;max-width:100%;}}
</style>
</head>
<body>
<div class="container">
  <a href="../" class="back-link">← Strona główna</a>
  <header>
    <div class="tag">Kalkulator kliniczny</div>
    <h1>CAT – COPD Assessment Test</h1>
    <p>Ocena wpływu POChP na stan zdrowia pacjenta · maks. 40 punktów</p>
  </header>

  <button class="reset-btn" onclick="resetAll()">↺ Resetuj wszystkie pola</button>

  <div id="cat-container"></div>

  <div class="result-panel">
    <div class="score-circle">
      <div class="score-number c-low" id="score-num">0</div>
      <div class="score-max">/ 40 pkt</div>
    </div>
    <div class="result-right">
      <div class="severity-label c-low" id="sev-label">Minimalny wpływ</div>
      <div class="severity-range" id="sev-range">CAT 0–9</div>
      <div class="result-desc" id="sev-desc">POChP ma minimalny wpływ na życie pacjenta.</div>
    </div>
  </div>

  <div class="source">
    Jones PW, et al. Development and first validation of the COPD Assessment Test. <em>Eur Respir J</em> 2009; 34(3): 648–654.
  </div>
</div>

<script>
const ITEMS = [
  { id:'i1', left:'Nigdy nie kaszlę', right:'Kaszlę cały czas' },
  { id:'i2', left:'Nie zalegają mi w ogóle wydzieliny (flegma) w płucach', right:'W moich płucach zalegają wydzieliny (flegma) całkowicie' },
  { id:'i3', left:'Nie czuję żadnego ucisku w klatce piersiowej', right:'Czuję bardzo duży ucisk w klatce piersiowej' },
  { id:'i4', left:'Kiedy idę pod górę lub po schodach, nie odczuwam duszności', right:'Gdy idę pod górę lub po schodach, odczuwam bardzo dużą duszność' },
  { id:'i5', left:'Bez ograniczeń wykonuję obowiązki domowe', right:'Wykonywanie obowiązków domowych jest bardzo ograniczone' },
  { id:'i6', left:'Mimo choroby płuc czuję się pewnie podczas wychodzenia z domu', right:'Z powodu choroby płuc nie czuję się pewnie podczas wychodzenia z domu' },
  { id:'i7', left:'Sypiam spokojnie', right:'Z powodu choroby płuc nie sypiam spokojnie' },
  { id:'i8', left:'Mam dużo energii', right:'Nie mam wcale energii' },
];

const OUTCOMES = [
  { max:9,  label:'Minimalny wpływ',     range:'CAT 0–9',   cls:'c-low',  desc:'POChP ma minimalny wpływ na życie pacjenta.' },
  { max:20, label:'Umiarkowany wpływ',   range:'CAT 10–20', cls:'c-mid',  desc:'POChP ma umiarkowany wpływ na życie. Wskazana optymalizacja leczenia i rehabilitacja pulmonologiczna.' },
  { max:30, label:'Duży wpływ',          range:'CAT 21–30', cls:'c-high', desc:'POChP ma duży wpływ na codzienne życie pacjenta. Konieczna intensyfikacja leczenia.' },
  { max:40, label:'Bardzo duży wpływ',   range:'CAT 31–40', cls:'c-high', desc:'POChP ma bardzo duży wpływ na wszystkie aspekty życia. Konieczna pilna ocena specjalistyczna.' },
];

const state = {};
ITEMS.forEach(i => state[i.id] = 0);

const container = document.getElementById('cat-container');
ITEMS.forEach((item, idx) => {
  const div = document.createElement('div');
  div.className = 'cat-item';
  div.innerHTML = `
    <div class="cat-labels">
      <span class="cat-label-left">${item.left}</span>
      <span class="cat-score-badge" id="sc-${item.id}">0</span>
      <span class="cat-label-right">${item.right}</span>
    </div>
    <div class="slider-row">
      <div class="scale-btns" data-param="${item.id}">
        ${[0,1,2,3,4,5].map((v,vi) => `<button class="scale-btn${vi===0?' selected':''}" data-val="${v}">${v}</button>`).join('')}
      </div>
    </div>`;
  container.appendChild(div);
});

document.querySelectorAll('.scale-btns').forEach(group => {
  const param = group.dataset.param;
  const btns = group.querySelectorAll('.scale-btn');
  btns.forEach(btn => {
    btn.addEventListener('click', () => {
      btns.forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
      state[param] = parseInt(btn.dataset.val) || 0;
      render();
    });
  });
});

function render() {
  let total = 0;
  ITEMS.forEach(i => total += state[i.id]);
  document.getElementById('score-num').textContent = total;
  const o = OUTCOMES.find(o => total <= o.max);
  document.getElementById('score-num').className = 'score-number ' + o.cls;
  const sevEl = document.getElementById('sev-label');
  sevEl.textContent = o.label; sevEl.className = 'severity-label ' + o.cls;
  document.getElementById('sev-range').textContent = o.range;
  document.getElementById('sev-desc').textContent = o.desc;
  ITEMS.forEach(i => {
    const el = document.getElementById('sc-' + i.id);
    if (!el) return;
    const pts = state[i.id];
    el.textContent = pts;
    el.className = 'cat-score-badge' + (pts > 0 ? ' scored' : '');
  });
}

function resetAll() {
  document.querySelectorAll('.scale-btns').forEach(group => {
    const btns = group.querySelectorAll('.scale-btn');
    btns.forEach(b => b.classList.remove('selected'));
    btns[0].classList.add('selected');
    state[group.dataset.param] = 0;
  });
  render();
}

render();
</script>
</body>
</html>
